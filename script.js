const MASTER_IPA = {
    // Chapter 1 & 2 Essentials
    "big":"/bɪɡ/", "still":"/stɪl/", "list":"/lɪst/", "film":"/fɪlm/", "win":"/wɪn/", "trip":"/trɪp/", "pick":"/pɪk/", "six":"/sɪks/", "give":"/ɡɪv/", "quick":"/kwɪk/", "kid":"/kɪd/", "skin":"/skɪn/", "hill":"/hɪl/", "miss":"/mɪs/", "hit":"/hɪt/", "bit":"/bɪt/", "risk":"/rɪsk/", "tip":"/tɪp/", "bill":"/bɪl/", "mix":"/mɪks/", "sick":"/sɪk/", "split":"/splɪt/", "twin":"/twɪn/", "fit":"/fɪt/", "sit":"/sɪt/", "hip":"/hɪp/", "tin":"/tɪn/", "kill":"/kɪl/", "stick":"/stɪk/", "lift":"/lɪft/", "man":"/mæn/", "back":"/bæk/", "tax":"/tæks/", "plan":"/plæn/", "mass":"/mæs/", "track":"/træk/", "tag":"/tæɡ/", "add":"/æd/", "van":"/væn/", "fact":"/fækt/", "brand":"/brænd/", "fat":"/fæt/", "stand":"/stænd/", "act":"/ækt/", "vat":"/væt/", "pack":"/pæk/", "tab":"/tæb/", "black":"/blæk/", "rant":"/rænt/", "snack":"/snæk/", "fan":"/fæn/", "wrap":"/ræp/", "gas":"/ɡæs/", "lab":"/læb/", "ban":"/bæn/", "lack":"/læk/", "cat":"/kæt/", "flat":"/flæt/", "hand":"/hænd/", "snap":"/snæp/", "tap":"/tæp/", "mat":"/mæt/", "trim":"/trɪm/", "strand":"/strænd/", "tick":"/tɪk/", "rack":"/ræk/", "lip":"/lɪp/", "drag":"/dræɡ/", "pin":"/pɪn/", "rim":"/rɪm/", "lap":"/læp/", "grin":"/ɡrɪn/", "lad":"/læd/", "wig":"/wɪɡ/", "scrap":"/skræp/", "grill":"/ɡrɪl/", "bat":"/bæt/", "wit":"/wɪt/", "span":"/spæn/", "lid":"/lɪd/", "valve":"/vælv/", "stiff":"/stɪf/", "skim":"/skɪm/", "wax":"/wæks/", "wrist":"/rɪst/", "grip":"/ɡrɪp/", "trap":"/træp/", "pill":"/pɪl/", "knit":"/nɪt/", "tram":"/træm/", "best":"/best/", "next":"/nekst/", "web":"/web/", "help":"/help/", "set":"/set/", "well":"/wel/", "press":"/pres/", "red":"/red/", "let":"/let/", "end":"/end/", "bread":"/bred/", "rent":"/rent/", "text":"/tekst/", "pet":"/pet/", "head":"/hed/", "den":"/den/", "rest":"/rest/", "friend":"/frend/", "step":"/step/", "dress":"/dres/", "bed":"/bed/", "bell":"/bel/", "neck":"/nek/", "desk":"/desk/", "spread":"/spred/", "pen":"/pen/", "wet":"/wet/", "mess":"/mes/", "hell":"/hel/", "ten":"/ten/", "top":"/tɒp/", "want":"/wɒnt/", "stop":"/stɒp/", "log":"/lɒɡ/", "stock":"/stɒk/", "cost":"/kɒst/", "rock":"/rɒk/", "hot":"/hɒt/", "golf":"/ɡɒlf/", "box":"/bɒks/", "loss":"/lɒs/", "bomb":"/bɒm/", "spot":"/spɒt/", "god":"/ɡɒd/", "boss":"/bɒs/", "block":"/blɒk/", "crop":"/krɒp/", "plot":"/plɒt/", "dog":"/dɒɡ/", "swan":"/swɒn/", "rob":"/rɒb/", "squad":"/skwɒd/", "bond":"/bɒnd/", "fox":"/fɒks/", "cross":"/krɒs/", "drop":"/drɒp/", "lock":"/lɒk/", "pot":"/pɒt/", "what":"/wɒt/", "up":"/ʌp/", "run":"/rʌn/", "love":"/lʌv/", "son":"/sʌn/", "plus":"/plʌs/", "front":"/frʌnt/", "club":"/klʌb/", "trust":"/trʌst/", "rough":"/rʌf/", "stuff":"/stʌf/", "hub":"/hʌb/", "drug":"/drʌɡ/", "pub":"/pʌb/", "cut":"/kʌt/", "hull":"/hʌl/", "tough":"/tʌf/", "cup":"/kʌp/", "hunt":"/hʌnt/", "plug":"/plʌɡ/", "blood":"/blʌd/", "bus":"/bʌs/", "bump":"/bʌmp/", "fund":"/fʌnd/", "truck":"/trʌk/", "bulk":"/bʌlk/", "gun":"/ɡʌn/", "ton":"/tʌn/", "sum":"/sʌm/", "tub":"/tʌb/", "puff":"/pʌf/", "look":"/lʊk/", "put":"/pʊt/", "good":"/ɡʊd/", "book":"/bʊk/", "full":"/fʊl/", "woof":"/wʊf/", "hook":"/hʊk/", "nook":"/nʊk/", "wood":"/wʊd/", "pull":"/pʊl/", "took":"/tʊk/", "wolf":"/wʊlf/", "stood":"/stʊd/", "cook":"/kʊk/", "foot":"/fʊt/", "crook":"/krʊk/", "hood":"/hʊd/", "rook":"/rʊk/", "brook":"/brʊk/", "bull":"/bʊl/", "wool":"/wʊl/", "delve":"/delv/", "dove (n.)":"/dʌv/", "trough":"/trɒf/", "when":"/wen/", "mollusc":"/ˈmɒl.əsk/",

    // CHAPTER 3 DATA (British RP)
    "shop":"/ʃɒp/", "push":"/pʊʃ/", "dish":"/dɪʃ/", "pressure":"/ˈpreʃ.ə/", "shrub":"/ʃrʌb/", "finish":"/ˈfɪn.ɪʃ/", "mesh":"/meʃ/", "sugar":"/ˈʃʊɡ.ə/", "shipment":"/ˈʃɪp.mənt/", "shun":"/ʃʌn/", "gnash":"/næʃ/", "shin":"/ʃɪn/", "sham":"/ʃæm/", "wish":"/wɪʃ/", "shelter":"/ˈʃel.tə/", "radish":"/ˈræd.ɪʃ/", "bush":"/bʊʃ/", "shocker":"/ˈʃɒk.ə/", "shelf":"/ʃelf/", "squash":"/skwɒʃ/", "Welsh":"/welʃ/", "fetish":"/ˈfet.ɪʃ/", "chef":"/ʃef/", "washer":"/ˈwɒʃ.ə/", "shepherd":"/ˈʃep.əd/", "fisher":"/ˈfɪʃ.ə/", "lush":"/lʌʃ/", "shell":"/ʃel/", "posh":"/pɒʃ/", "shatter":"/ˈʃæt.ə/", "ship":"/ʃɪp/", "blush":"/blʌʃ/", "shred":"/ʃred/", "shove":"/ʃʌv/", "wash":"/wɒʃ/", "sheriff":"/ˈʃer.ɪf/", "shed":"/ʃed/", "fissure":"/ˈfɪʃ.ə/", "smash":"/smæʃ/", "cash":"/kæʃ/",
    "pleasure":"/ˈpleʒ.ə/", "leisure":"/ˈleʒ.ə/", "measure":"/ˈmeʒ.ə/", "treasure":"/ˈtreʒ.ə/",
    "chest":"/ʧest/", "match":"/mæʧ/", "vulture":"/ˈvʌl.ʧə/", "watch":"/wɒʧ/", "hatchet":"/ˈhæʧ.ɪt/", "chip":"/ʧɪp/", "rich":"/rɪʧ/", "inch":"/ɪnʧ/", "lecture":"/ˈlek.ʧə/", "signature":"/ˈsɪɡ.nə.ʧə/", "butcher":"/ˈbʊʧ.ə/", "twitch":"/twɪʧ/", "bunch":"/bʌnʧ/", "patch":"/pæʧ/", "which":"/wɪʧ/", "chop":"/ʧɒp/", "lunch":"/lʌnʧ/", "chimp":"/ʧɪmp/", "culture":"/ˈkʌl.ʧə/", "notch":"/nɒʧ/", "wrench":"/renʧ/", "hatch":"/hæʧ/", "quench":"/kwenʧ/", "chicken":"/ˈʧɪk.ɪn/", "itch":"/ɪʧ/", "check":"/ʧek/", "bachelor":"/ˈbæʧ.əl.ə/", "scratch":"/skræʧ/", "touch":"/tʌʧ/", "catch":"/kæʧ/", "sculpture":"/ˈskʌlp.ʧə/", "glitch":"/ɡlɪʧ/", "blotch":"/blɒʧ/", "venture":"/ˈven.ʧə/", "pitch":"/pɪʧ/", "batch":"/bæʧ/", "fracture":"/ˈfræk.ʧə/", "drench":"/drenʧ/", "zilch":"/zɪlʧ/", "crutch":"/krʌʧ/",
    "badge":"/bæʤ/", "vintage":"/ˈvɪn.tɪʤ/", "algebra":"/ˈæl.ʤɪ.brə/", "jet":"/ʤet/", "suggest":"/səˈʤest/", "jacket":"/ˈʤæk.ɪt/", "gin":"/ʤɪn/", "jab":"/ʤæb/", "package":"/ˈpæk.ɪʤ/", "binge":"/bɪnʤ/", "hedge":"/heʤ/", "digit":"/ˈdɪʤ.ɪt/", "ninja":"/ˈnɪn.ʤə/", "syringe":"/sɪˈrɪnʤ/", "carriage":"/ˈkær.ɪʤ/", "jazz":"/ʤæz/", "edge":"/eʤ/", "spillage":"/ˈspɪl.ɪʤ/", "wedge":"/weʤ/", "jam":"/ʤæm/", "singe":"/sɪnʤ/", "cottage":"/ˈɒt.ɪʤ/", "gadget":"/ˈɡæʤ.ɪt/", "dodge":"/dɒʤ/", "jump":"/ʤʌmp/", "fudge":"/fʌʤ/", "plunger":"/ˈplʌn.ʤə/", "image":"/ˈɪm.ɪʤ/", "register":"/ˈreʤ.ɪ.stə/", "nudge":"/nʌʤ/", "gist":"/ʤɪst/", "cabbage":"/ˈkæb.ɪʤ/", "pledge":"/pleʤ/", "fidget":"/ˈfɪʤ.ɪt/", "Japan":"/ʤəˈpæn/", "passage":"/ˈpæs.ɪʤ/", "sausage":"/ˈsɒs.ɪʤ/", "smudge":"/smʌʤ/",
    "yob":"/jɒb/", "canyon":"/ˈkæn.jən/", "yoghurt":"/ˈjɒɡ.ət/", "yap":"/jæp/", "yet":"/jet/", "yelp":"/jelp/", "yonder":"/ˈjɒn.də/", "yacht":"/jɒt/", "yak":"/jæk/", "yam":"/jæm/", "yell":"/jel/", "yuck":"/jʌk/", "yum":"/jʌm/", "Yen":"/jen/", "yes":"/jes/",
    "bank":"/bæŋk/", "pudding":"/ˈpʊd.ɪŋ/", "sing":"/sɪŋ/", "drunk":"/drʌŋk/", "anchor":"/ˈæŋ.kə/", "gang":"/ɡæŋ/", "song":"/sɒŋ/", "link":"/lɪŋk/", "rank":"/ræŋk/", "kink":"/kɪŋk/", "ping":"/pɪŋ/", "tongue":"/tʌŋ/", "king":"/kɪŋ/", "twang":"/twæŋ/", "monk":"/mʌŋk/", "wink":"/wɪŋk/", "bring":"/brɪŋ/", "honk":"/hɒŋk/", "kingdom":"/ˈkɪŋ.dəm/", "flank":"/flæŋk/", "wrong":"/rɒŋ/", "bung":"/bʌŋ/", "linger":"/ˈlɪŋ.ɡə/", "tank":"/tæŋk/", "sibling":"/ˈsɪb.lɪŋ/", "sarong":"/səˈrɒŋ/", "booking":"/ˈbʊk.ɪŋ/", "wedding":"/ˈwed.ɪŋ/", "punk":"/pʌŋk/", "pang":"/pæŋ/", "yank":"/jæŋk/", "finger":"/ˈfɪŋ.ɡə/", "spring":"/sprɪŋ/", "clink":"/klɪŋk/", "fling":"/flɪŋ/", "drink":"/drɪŋk/", "shilling":"/ˈʃɪl.ɪŋ/", "hang":"/hæŋ/", "hunger":"/ˈhʌŋ.ɡə/", "conquer":"/ˈkɒŋ.kə/", "prank":"/præŋk/",
    "this":"/ðɪs/", "with":"/wɪð/", "other":"/ˈʌð.ə/", "weather":"/ˈweð.ə/", "another":"/əˈnʌð.ə/", "together":"/təˈɡeð.ə/", "whether":"/ˈweð.ə/", "mother":"/ˈmʌð.ə/", "leather":"/ˈleð.ə/", "brother":"/ˈbrʌð.ə/", "that":"/ðæt/", "gather":"/ˈɡæð.ə/", "thus":"/ðʌs/", "bother":"/ˈbɒð.ə/",
    "thatcher":"/ˈθæʧ.ə/", "health":"/helθ/", "thing":"/θɪŋ/", "think":"/θɪŋk/", "thank":"/θæŋk/", "death":"/deθ/", "smith":"/smɪθ/", "threat":"/θret/", "method":"/ˈmeθ.əd/", "thumb":"/θʌm/", "thread":"/θred/", "thick":"/θɪk/", "nothing":"/ˈnʌθ.ɪŋ/", "thin":"/θɪn/", "theft":"/θeft/", "thriller":"/ˈθrɪl.ə/", "wealth":"/welθ/", "thrill":"/θrɪl/", "depth":"/depθ/", "myth":"/mɪθ/", "thong":"/θɒŋ/",
    "breath":"/breθ/", "chapter":"/ˈʧæp.tə/", "wing":"/wɪŋ/", "midge":"/mɪʤ/", "flourish":"/ˈflʌr.ɪʃ/", "tether":"/ˈteð.ə/", "bulge":"/bʌlʤ/", "hush":"/hʌʃ/", "filth":"/fɪlθ/", "building":"/ˈbɪl.dɪŋ/", "adventure":"/ədˈven.ʧə/", "blemish":"/ˈblem.ɪʃ/", "ginger":"/ˈʤɪn.ʤə/", "mammoth":"/ˈmæm.əθ/", "anger":"/ˈæŋ.ɡə/", "shimmer":"/ˈʃɪm.ə/", "college":"/ˈkɒl.ɪʤ/", "challenge":"/ˈʧæl.ɪnʤ/", "bishop":"/ˈbɪʃ.əp/", "Gothic":"/ˈɡɒθ.ɪk/", "spelling":"/ˈspel.ɪŋ/", "punch":"/pʌnʧ/", "shutter":"/ˈʃʌt.ə/", "plethora":"/ˈpleθ.ər.ə/", "junk":"/ʤʌŋk/", "stricture":"/ˈstrɪk.ʧə/", "sponge":"/spʌnʤ/", "parish":"/ˈpær.ɪʃ/", "winch":"/wɪnʧ/", "damage":"/ˈdæm.ɪʤ/", "meringue":"/məˈræŋ/", "feather":"/ˈfeð.ə/", "thug":"/θʌɡ/", "relish":"/ˈrel.ɪʃ/", "scrunch":"/skrʌnʧ/", "ligature":"/ˈlɪɡ.ə.ʧə/", "message":"/ˈmes.ɪʤ/", "gangster":"/ˈɡæŋ.stə/", "ethnic":"/ˈeθ.nɪk/", "wither":"/ˈwɪð.ə/", "shrimp":"/ʃrɪmp/", "belch":"/belʧ/", "gender":"/ˈʤen.də/", "attachment":"/əˈtæʧ.mənt/", "jogger":"/ˈʤɒɡ.ə/", "inkling":"/ˈɪŋ.klɪŋ/", "thorough":"/ˈθʌr.ə/", "splash":"/splæʃ/", "smother":"/ˈsmʌð.ə/", "stretcher":"/ˈstreʧ.ə/", "percentage":"/pəˈsen.tɪʤ/", "gong":"/ɡɒŋ/", "chill":"/ʧɪl/", "genetic":"/ʤəˈnet.ɪk/", "cloth":"/klɒθ/", "conjecture":"/kənˈʤek.ʧə/", "fledgling":"/ˈfleʤ.lɪŋ/", "chunk":"/ʧʌŋk/", "shopper":"/ˈʃɒp.ə/", "stealth":"/stelθ/", "lung":"/lʌŋ/", "ash":"/æʃ/", "chick":"/ʧɪk/", "lodge":"/lɒʤ/", "attach":"/əˈtæʧ/", "shrink":"/ʃrɪŋk/", "moth":"/mɒθ/", "ranking":"/ˈræŋ.kɪŋ/", "slither":"/ˈslɪð.ə/", "shunt":"/ʃʌnt/", "jilt":"/ʤɪlt/", "pink":"/pɪŋk/", "chin":"/ʧɪn/", "rapture":"/ˈræp.ʧə/", "marriage":"/ˈmær.ɪʤ/", "bang":"/bæŋ/", "crotch":"/krɒʧ/", "heather":"/ˈheð.ə/", "shrill":"/ʃrɪl/", "switch":"/swɪʧ/", "lunge":"/lʌnʤ/", "string":"/strɪŋ/"
};

const CHAPTERS = [
    {
        title: "Short Vowels",
        sections: [
            { name: "The kit /ɪ/ vowel", instr: "Transcribe words with the kit /ɪ/ vowel.", words: "big, still, list, film, win, trip, pick, six, give, quick, kid, skin, hill, miss, hit, bit, risk, tip, bill, mix, sick, split, twin, fit, sit, hip, tin, kill, stick, lift" },
            { name: "The trap /æ/ vowel", instr: "Transcribe words with the trap /æ/ vowel.", words: "man, back, tax, plan, mass, track, tag, add, van, fact, brand, fat, stand, act, vat, pack, tab, black, rant, snack, fan, wrap, gas, lab, ban, lack, cat, flat, hand, snap" },
            { name: "The kit /ɪ/, trap /æ/ revision", instr: "Transcribe words with /ɪ/ or /æ/.", words: "tap, mat, trim, strand, tick, rack, lip, drag, pin, rim, lap, grin, lad, wig, scrap, grill, bat, wit, span, lid, valve, stiff, skim, wax, wrist, grip, trap, pill, knit, tram" },
            { name: "The dress /e/ vowel", instr: "Transcribe words with the dress /e/ vowel.", words: "best, next, web, help, set, well, press, red, let, end, bread, rent, text, pet, head, den, rest, friend, step, dress, bed, bell, neck, desk, spread, pen, wet, mess, hell, ten" },
            { name: "Kit, Trap, Dress Revision", instr: "Transcribe with /ɪ/, /æ/ or /e/.", words: "nest, wag, vet, lick, bent, limb, melt, flint, axe, pest, drift, rag, drip, pram, sift, vent, fig, tract, skid, tread, din, nip, sap, deck, gift, dam, frisk, crest, glint, ramp, kilt, plaid, lilt, nick, glen, kit, damp, lag, sniff, crab" },
            { name: "The lot /ɒ/ vowel", instr: "Transcribe with the lot /ɒ/ vowel.", words: "top, want, stop, log, stock, cost, rock, hot, golf, box, loss, bomb, spot, god, boss, block, crop, plot, dog, swan, rob, squad, bond, fox, cross, drop, lock, pot, what" },
            { name: "Kit, Trap, Dress, Lot Revision", instr: "Transcribe with /ɪ/, /æ/, /e/ or /ɒ/.", words: "quill, keg, sag, twig, silt, flock, crib, pact, sect, cleanse, smack, mop, knock, limp, fad, whim, mend, fizz, amp, bib, wand, squint, slack, scalp, fog, wren, cod, bless, bid, clamp, guild, zap, splint, frill, elm, dock, wasp, cog, whisk, bend" },
            { name: "The strut /ʌ/ vowel", instr: "Transcribe with the strut /ʌ/ vowel.", words: "up, run, love, son, plus, front, club, trust, rough, stuff, hub, drug, pub, cut, hull, tough, cup, hunt, plug, blood, bus, bump, fund, truck, bulk, gun, ton, sum, tub, puff" },
            { name: "Five Vowel Revision", instr: "Transcribe with /ɪ/, /æ/, /e/, /ɒ/ or /ʌ/.", words: "dull, delve, hum, quack, crypt, lust, gloss, dove (n.), tusk, swamp, trough, squat, scrub, when, scuff, snag, none, swill, cuff, glove, cot, cyst, muck, swat, bulb, whack, tug, fob, bud, stomp, buck, dread, blimp, trot, wok, wad, beg, hob" },
            { name: "The foot /ʊ/ vowel", instr: "Transcribe with the foot /ʊ/ vowel.", words: "look, put, good, book, full, woof, hook, nook, wood, pull, took, wolf, stood, cook, foot, crook, hood, rook, brook, bull, wool" },
            { name: "Short Vowels Comprehensive", instr: "Comprehensive short vowels revision.", words: "quit, ram, wolf, egg, trick, buzz, scant, swap, cliff, flood, quest, skull, guess, squid, helm, rub, scab, smog, peg, snug, quilt, crack, knot, bull, kick, strut, floss, scrum, book, sweat, cough, slam, duck, sieve, blob, twist, gulf, spell, doll, foot, clump, plait, scan, fix, twelve, blonde, hymn, drum, hook, knack, sculpt, whelk, bronze, frizz, gut, gram, quell, frost, swab, hem, stud, breast, smock, build, pat, milk, realm, blitz, pull, sulk, sob, ant, fib, crumb, stress, sock, spill, smell, pulse, frock, flex, clan, lapse, frog, mud, swim, hump, scamp, clock, wool, pond, cull, lamb, mock, zip, swift, stamp, pant, mob, kiss, weld, quip, script, dud, stood, sand, silk, slop, slab, sprint, plump, crust, whip, bog, disc, rook, rot, mill, gland" }
        ]
    },
    {
        title: "Schwa & Unstressed",
        sections: [
            { name: "Schwa /ə/", instr: "Transcribe with /ə/. Use stress marks (ˈ).", words: "gallon, above, panda, villain, collapse, syrup, lemon, protect, extra, canal, arrest, tenant, parrot, alpha, campus, welcome, lapel, cactus, collect, bullock, stomach, buttock, correct, woollen, villa, husband, assess, heron, breakfast, atlas, Christmas, maggot, atom, cadet, felon, zebra, possess, melon, hammock, adopt, comma, gazette, gammon, dragon, column, salad, gallop, stigma, ballad, attract" },
            { name: "Schwa /ə/ with <r>", instr: "Transcribe words with <r> in spelling. Use (ˈ).", words: "doctor, lizard, terror, copper, butter, monarch, forgive, cover, hover, blizzard, figure, liquor, ponder, forget, rigour, grammar, actor, suffer, concert, offer, persist, whisper, sponsor, vulgar, sulphur, otter, centre, honour, enter, standard, plumber, collar, leopard, mirror, glamour, custard, timber, cupboard, effort, differ" },
            { name: "Polysyllabic Schwa /ə/", instr: "Transcribe polysyllabic words with (ˈ).", words: "wilderness, professor, asparagus, customer, abacus, consider, vanilla, photographer, instrument, propeller, predator, savannah, charisma, surrender, conundrum, gorilla, hazardous, prospectus, adamant, astronomer, adaptor" },
            { name: "Unstressed kit /ɪ/", instr: "Transcribe with unstressed kit /ɪ/.", words: "comic, invest, rabbit, women, solid, rapid, visit, epic, biscuit, locket, imposter, bucket, limit, cricket, minute, attic, robin, coffin, rustic, puppet, captive, intent, ticket, classic, profit, resin, haggis, bandit, tonic, Latin, instructor, pocket, promise, plastic, comet, relic, lyric, goblin, statistic, habit, public, passive, cabin, laxative, picnic, rocket, gossip, narrative, olive" },
            { name: "Schwa /ə/ vs kit /ɪ/", instr: "Transcribe /ə/ or /ɪ/ based on your speech.", words: "victim, select, lettuce, necklace, bullet, kebab, palace, anonymous, politics, honest, helmet, character, foreign, menace, magnet, mechanic, tablet, rivet, facet, wallet, minimum, solicitor, forest, tremendous, eldest, mallet, spirit, bannister, cement, maximum, pallet, specific, solace, captain, minister, terrace, pessimist, element, obstinate, philosopher, apprentice, heretic, neglect" },
            { name: "Final Revision", instr: "Mixed unstressed syllable revision.", words: "custom, matter, assessment, office, closet, primitive, carrot, puffin, mantra, pumpkin, plunder, phantom, offender, planet, calendar, moral, dollop, napkins, summer, dolphin, cylinder, packet, veranda, wagon, socket, occurrence, paddock, crevice, discipline, buzzard, balance, patella, pasta, ultimate, sinister, involvement, hammer, suspend, summon, positive, exodus, common, sister, mollusc, topic, mustard, corrupt, compass, member, novice, negative, hospice, succumb, testament, tandem, configure, lobster, talent, attend, canvas, massacre, offend, pivot, cooker, hazard, splendour, pelvis, dollar, tractor, woman, across, borough, summit, placenta, problem, absolve, horror, ballot, dogma, analysis, syllabus, obstruct, clever, suppress, pilgrim, optimist, citrus, commit" }
        ]
    },
    {
        title: "Consonants",
        sections: [
            { name: "The Postalveolar Fricative /ʃ/", instr: "Transcribe these words with /ʃ/.", words: "shop, push, dish, pressure, shrub, finish, mesh, sugar, shipment, shun, gnash, shin, sham, wish, shelter, radish, bush, shocker, shelf, squash, Welsh, fetish, chef, washer, shepherd, fisher, lush, shell, posh, shatter, ship, blush, shred, shove, wash, sheriff, shed, fissure, smash, cash" },
            { name: "The Postalveolar Fricative /ʒ/", instr: "Transcribe these words with /ʒ/.", words: "pleasure, leisure, measure, treasure" },
            { name: "Postalveolar Affricate /ʧ/", instr: "Transcribe these words with /ʧ/.", words: "chest, match, vulture, watch, hatchet, chip, rich, inch, lecture, signature, butcher, twitch, bunch, patch, which, chop, lunch, chimp, culture, notch, wrench, hatch, quench, chicken, itch, check, bachelor, scratch, touch, catch, sculpture, glitch, blotch, venture, pitch, batch, fracture, drench, zilch, crutch" },
            { name: "Postalveolar Affricate /ʤ/", instr: "Transcribe these words with /ʤ/.", words: "badge, vintage, algebra, jet, suggest, jacket, gin, jab, package, binge, hedge, digit, ninja, syringe, carriage, jazz, edge, spillage, wedge, jam, singe, cottage, gadget, dodge, jump, fudge, plunger, image, register, nudge, gist, cabbage, pledge, fidget, Japan, passage, sausage, smudge" },
            { name: "Palatal Approximant /j/", instr: "Transcribe these words with /j/.", words: "yob, canyon, yoghurt, yap, yet, yelp, yonder, yacht, yak, yam, yell, yuck, yum, Yen, yes" },
            { name: "Velar Nasal /ŋ/", instr: "Transcribe these words with /ŋ/.", words: "bank, pudding, sing, drunk, anchor, gang, song, link, rank, kink, ping, tongue, king, twang, monk, wink, bring, honk, kingdom, flank, wrong, bung, linger, tank, sibling, sarong, booking, wedding, punk, pang, yank, finger, spring, clink, fling, drink, shilling, hang, hunger, conquer, prank" },
            { name: "Dental Fricative /ð/", instr: "Transcribe these words with /ð/.", words: "this, with, other, weather, another, together, whether, mother, leather, brother, that, gather, thus, bother" },
            { name: "Dental Fricative /θ/", instr: "Transcribe these words with /θ/.", words: "thatcher, health, thing, think, thank, death, smith, threat, method, thumb, thread, thick, nothing, thin, theft, thriller, wealth, thrill, depth, myth, thong" },
            { name: "/ʃ ʒ ʧ ʤ j ŋ θ ð/ Revision", instr: "Mixed revision for consonant sounds.", words: "breath, chapter, yet, wing, midge, flourish, tether, bulge, hush, filth, building, treasure, adventure, blemish, ginger, mammoth, anger, shimmer, college, challenge, bishop, Gothic, spelling, yonder, punch, shutter, plethora, junk, stricture, sponge, parish, winch, damage, meringue, feather, pleasure, thug, relish, scrunch, canyon, ligature, message, gangster, ethnic, wither, shrimp, belch, gender, measure, attachment, jogger, inkling, thorough, splash, smother, yak, stretcher, percentage, gong, chill, genetic, cloth, conjecture, fledgling, chunk, shopper, stealth, lung, ash, chick, yacht, lodge, attach, shrink, moth, yob, ranking, slither, shunt, jilt, pink, chin, rapture, marriage, bang, crotch, heather, yank, shrill, switch, lunge, string" }
        ]
    }
];

let state = { view: 'menu', chapterIdx: 0, sectionIdx: 0, wordIdx: 0, words: [] };
let feedbackTimer;

function init() {
    renderChapters();
    document.addEventListener('keydown', handleKeys);
}

function handleKeys(e) {
    if (state.view === 'menu') {
        const n = parseInt(e.key);
        if (n > 0 && n <= CHAPTERS.length) selectChapter(n - 1);
    } else if (state.view === 'section-menu') {
        if (e.key === 'Escape') showView('menu');
        const code = e.key.toUpperCase();
        const keys = "123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const idx = keys.indexOf(code);
        if (idx !== -1 && idx < CHAPTERS[state.chapterIdx].sections.length) selectSection(idx);
    } else if (state.view === 'exercise') {
        if (e.key === 'Escape') showView('section-menu');
        if (e.key === 'Enter') checkAnswer();
    }
}

function showView(viewName) {
    state.view = viewName;
    document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
    
    const target = document.getElementById(viewName + '-view');
    if (target) target.classList.remove('hidden');

    if (viewName === 'exercise') {
        const inp = document.getElementById('ipa-input');
        if (inp) {
            inp.value = '';
            inp.focus();
        }
    }
}

function renderChapters() {
    const list = document.getElementById('chapter-list');
    list.innerHTML = '';
    CHAPTERS.forEach((ch, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<span>${ch.title}</span><span class="item-key">[${i+1}]</span>`;
        div.onclick = () => selectChapter(i);
        list.appendChild(div);
    });
}

function selectChapter(idx) {
    state.chapterIdx = idx;
    const ch = CHAPTERS[idx];
    document.getElementById('active-chapter-title').textContent = ch.title.toUpperCase();
    const list = document.getElementById('section-list');
    list.innerHTML = '';
    const keys = "123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    ch.sections.forEach((sec, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<span>${sec.name}</span><span class="item-key">[${keys[i]}]</span>`;
        div.onclick = () => selectSection(i);
        list.appendChild(div);
    });
    showView('section-menu');
}

function selectSection(idx) {
    state.sectionIdx = idx;
    const sec = CHAPTERS[state.chapterIdx].sections[idx];
    state.words = sec.words.split(', ').map(w => w.trim());
    state.wordIdx = 0;
    
    document.getElementById('chapter-label').textContent = CHAPTERS[state.chapterIdx].title;
    document.getElementById('section-label').textContent = sec.name;
    document.getElementById('instruction-text').textContent = sec.instr;
    
    showView('exercise');
    renderWord();
}

function renderWord() {
    const word = state.words[state.wordIdx];
    document.getElementById('word-display').textContent = word;
    document.getElementById('ipa-input').value = '';
    document.getElementById('feedback').textContent = '';
    updateProgress();
}

function updateProgress() {
    const current = state.wordIdx + 1;
    const total = state.words.length;
    document.getElementById('counter').textContent = `${current} / ${total}`;
    document.getElementById('progress-fill').style.width = `${(current / total) * 100}%`;
}

function checkAnswer() {
    const fb = document.getElementById('feedback');
    const input = document.getElementById('ipa-input').value.trim();
    const word = state.words[state.wordIdx];
    const correct = MASTER_IPA[word] || "N/A";
    const cleanInput = input.startsWith('/') ? input : `/${input}/`;

    if (cleanInput === correct) {
        fb.textContent = 'CORRECT';
        fb.style.color = 'var(--success)';
        
        clearTimeout(feedbackTimer);
        feedbackTimer = setTimeout(() => {
            state.wordIdx++;
            if (state.wordIdx < state.words.length) {
                renderWord();
            } else {
                showView('section-menu');
            }
        }, 600);
    } else {
        fb.textContent = `EXPECTED: ${correct}`;
        fb.style.color = 'var(--error)';
    }
}

document.getElementById('exit-btn').onclick = () => showView('section-menu');
init();
